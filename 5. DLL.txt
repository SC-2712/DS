#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define ROWS 10
#define SEATS 7

struct Seat {
    int seat_no;
    char status[10];
    struct Seat *prev, *next;
};

struct Seat *head[ROWS];

void create_theater() {
    for (int i = 0; i < ROWS; i++) {
        struct Seat *prev = NULL, *temp = NULL;
        for (int j = 1; j <= SEATS; j++) {
            struct Seat *newSeat = (struct Seat *)malloc(sizeof(struct Seat));
            newSeat->seat_no = j;
            strcpy(newSeat->status, "Available");
            newSeat->next = NULL;
            newSeat->prev = prev;
            if (prev != NULL)
                prev->next = newSeat;
            else
                head[i] = newSeat;
            prev = newSeat;
        }
    }
}

void display() {
    printf("\n---- Seat Status ----\n");
    for (int i = 0; i < ROWS; i++) {
        struct Seat *temp = head[i];
        printf("Row %d: ", i + 1);
        while (temp) {
            printf("[%d:%c] ", temp->seat_no, temp->status[0]);
            temp = temp->next;
        }
        printf("\n");
    }
    printf("----------------------\n");
}

void book_seat(int row, int seat) {
    if (row < 1 || row > ROWS || seat < 1 || seat > SEATS) {
        printf("Invalid seat!\n");
        return;
    }
    struct Seat *temp = head[row - 1];
    while (temp) {
        if (temp->seat_no == seat) {
            if (strcmp(temp->status, "Booked") == 0)
                printf("Seat already booked!\n");
            else {
                strcpy(temp->status, "Booked");
                printf("Seat %d in Row %d booked successfully!\n", seat, row);
            }
            return;
        }
        temp = temp->next;
    }
}

void cancel_seat(int row, int seat) {
    if (row < 1 || row > ROWS || seat < 1 || seat > SEATS) {
        printf("Invalid seat!\n");
        return;
    }
    struct Seat *temp = head[row - 1];
    while (temp) {
        if (temp->seat_no == seat) {
            if (strcmp(temp->status, "Available") == 0)
                printf("Seat not booked yet!\n");
            else {
                strcpy(temp->status, "Available");
                printf("Booking of Seat %d in Row %d cancelled!\n", seat, row);
            }
            return;
        }
        temp = temp->next;
    }
}

int main() {
    int choice, row, seat;
    create_theater();
    book_seat(1, 3);
    book_seat(2, 5);
    book_seat(4, 1);
    while (1) {
        printf("\n1. Display Seats\n2. Book Seat\n3. Cancel Booking\n4. Exit\nEnter choice: ");
        scanf("%d", &choice);
        switch (choice) {
            case 1:
                display();
                break;
            case 2:
                printf("Enter Row (1-10): ");
                scanf("%d", &row);
                printf("Enter Seat (1-7): ");
                scanf("%d", &seat);
                book_seat(row, seat);
                break;
            case 3:
                printf("Enter Row (1-10): ");
                scanf("%d", &row);
                printf("Enter Seat (1-7): ");
                scanf("%d", &seat);
                cancel_seat(row, seat);
                break;
            case 4:
                printf("Exiting...\n");
                return 0;
            default:
                printf("Invalid choice!\n");
        }
    }
}


1. Display Seats
2. Book Seat
3. Cancel Booking
4. Exit
Enter choice: 1

---- Seat Status ----
Row 1: [1:A] [2:A] [3:B] [4:A] [5:A] [6:A] [7:A]
Row 2: [1:A] [2:A] [3:A] [4:A] [5:B] [6:A] [7:A]
Row 3: [1:A] [2:A] [3:A] [4:A] [5:A] [6:A] [7:A]
Row 4: [1:B] [2:A] [3:A] [4:A] [5:A] [6:A] [7:A]
Row 5: [1:A] [2:A] [3:A] [4:A] [5:A] [6:A] [7:A]
Row 6: [1:A] [2:A] [3:A] [4:A] [5:A] [6:A] [7:A]
Row 7: [1:A] [2:A] [3:A] [4:A] [5:A] [6:A] [7:A]
Row 8: [1:A] [2:A] [3:A] [4:A] [5:A] [6:A] [7:A]
Row 9: [1:A] [2:A] [3:A] [4:A] [5:A] [6:A] [7:A]
Row 10: [1:A] [2:A] [3:A] [4:A] [5:A] [6:A] [7:A]
----------------------

Enter choice: 2
Enter Row (1-10): 1
Enter Seat (1-7): 5
Seat 5 in Row 1 booked successfully!

Enter choice: 3
Enter Row (1-10): 2
Enter Seat (1-7): 5
Booking of Seat 5 in Row 2 cancelled!

Enter choice: 4
Exiting...
